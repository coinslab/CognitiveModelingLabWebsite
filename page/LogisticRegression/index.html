<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/CognitiveModelingLabWebsite/libs/highlight/github.min.css"> <link rel=stylesheet  href="/CognitiveModelingLabWebsite/css/franklin.css"> <link rel=stylesheet  href="/CognitiveModelingLabWebsite/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/CognitiveModelingLabWebsite/assets/favicon.png"> <title>Logistic Regression</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h4><a href="/CognitiveModelingLabWebsite/">Computational Cognitive Modeling Lab</a></h4> <p class=lead >A first course in modeling for Behavioral & Brain Scientists.</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/CognitiveModelingLabWebsite/">Home</a> <a class="sidebar-nav-item " href="/CognitiveModelingLabWebsite/software-setup/">Software Setup</a> <a class="sidebar-nav-item " href="/CognitiveModelingLabWebsite/data-handling/">Data Handling</a> <a class="sidebar-nav-item " href="/CognitiveModelingLabWebsite/model-zoo/">Model Zoo</a> </nav> <p>&copy; Cognitive Informatics and Statistics Lab.</p> </div> </div> <div class="content container"> <div class=franklin-content ><h1 id=logistic_regression ><a href="#logistic_regression">Logistic Regression </a></h1> <div class=colbox-yellow >All code used in this module is available <a href="https://github.com/coinslab/ComputationalCognitiveModeling/blob/main/julia-scripts/model-zoo/logisitic.jl">here</a>.</div> <h2 id=loading_packages ><a href="#loading_packages">Loading Packages</a></h2> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> DataFrames, CSV, ScikitLearn, PyPlot</code></pre>
<ul>
<li><p>The above line of code will load the <code>CSV</code>,<code>DataFrames</code> &amp; <code>ScikitLearn</code> packages. </p>
<ul>
<li><p>If you get error while executing the above line of code that means you have missed installing one or more packages. By checking the error message, you can figure out which package is missing. </p>

<li><p>Add the missing package by entering the package mode and installing them. </p>

<li><p>Once done with installing the missing packages, try re-running the above line of code.</p>

</ul>

</ul>
<h2 id=loading_the_dataset ><a href="#loading_the_dataset">Loading the dataset </a></h2>
<pre><code class="julia hljs">data = CSV.File(<span class=hljs-string >&quot;covid_cleaned.csv&quot;</span>) |&gt; DataFrame</code></pre>
<pre><code class="julia hljs"><span class=hljs-number >20352</span>×<span class=hljs-number >16</span> DataFrame
   Row │ intubed  pneumonia  age    pregnancy  diabetes  copd   asthma  inmsupr  hypertension  other_disease  cardiovascular  obesity  renal_chronic  tobacco  contact_other_covid  covid_res 
       │ <span class=hljs-built_in >Int64</span>    <span class=hljs-built_in >Int64</span>      <span class=hljs-built_in >Int64</span>  <span class=hljs-built_in >Int64</span>      <span class=hljs-built_in >Int64</span>     <span class=hljs-built_in >Int64</span>  <span class=hljs-built_in >Int64</span>   <span class=hljs-built_in >Int64</span>    <span class=hljs-built_in >Int64</span>         <span class=hljs-built_in >Int64</span>          <span class=hljs-built_in >Int64</span>           <span class=hljs-built_in >Int64</span>    <span class=hljs-built_in >Int64</span>          <span class=hljs-built_in >Int64</span>    <span class=hljs-built_in >Int64</span>                <span class=hljs-built_in >Int64</span>     
───────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
     <span class=hljs-number >1</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >0</span>     <span class=hljs-number >25</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >1</span>          <span class=hljs-number >1</span>
     <span class=hljs-number >2</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >0</span>     <span class=hljs-number >52</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >1</span>              <span class=hljs-number >0</span>        <span class=hljs-number >1</span>                    <span class=hljs-number >1</span>          <span class=hljs-number >1</span>
     <span class=hljs-number >3</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >1</span>     <span class=hljs-number >51</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >1</span>          <span class=hljs-number >1</span>
     <span class=hljs-number >4</span> │       <span class=hljs-number >1</span>          <span class=hljs-number >1</span>     <span class=hljs-number >67</span>          <span class=hljs-number >0</span>         <span class=hljs-number >1</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >1</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >1</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >1</span>          <span class=hljs-number >1</span>
     <span class=hljs-number >5</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >1</span>     <span class=hljs-number >59</span>          <span class=hljs-number >0</span>         <span class=hljs-number >1</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >1</span>          <span class=hljs-number >1</span>
     <span class=hljs-number >6</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >0</span>     <span class=hljs-number >52</span>          <span class=hljs-number >0</span>         <span class=hljs-number >1</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >1</span>              <span class=hljs-number >0</span>               <span class=hljs-number >1</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >1</span>
     <span class=hljs-number >7</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >1</span>     <span class=hljs-number >54</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >1</span>
     <span class=hljs-number >8</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >1</span>     <span class=hljs-number >78</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >1</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >1</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >1</span>          <span class=hljs-number >1</span>
   ⋮   │    ⋮         ⋮        ⋮        ⋮         ⋮        ⋮      ⋮        ⋮          ⋮              ⋮              ⋮            ⋮           ⋮           ⋮              ⋮               ⋮
 <span class=hljs-number >20346</span> │       <span class=hljs-number >1</span>          <span class=hljs-number >1</span>     <span class=hljs-number >65</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >0</span>
 <span class=hljs-number >20347</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >1</span>     <span class=hljs-number >49</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >0</span>
 <span class=hljs-number >20348</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >1</span>     <span class=hljs-number >80</span>          <span class=hljs-number >0</span>         <span class=hljs-number >1</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >0</span>
 <span class=hljs-number >20349</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >0</span>     <span class=hljs-number >13</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >0</span>
 <span class=hljs-number >20350</span> │       <span class=hljs-number >1</span>          <span class=hljs-number >0</span>     <span class=hljs-number >23</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >1</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >1</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >0</span>
 <span class=hljs-number >20351</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >1</span>      <span class=hljs-number >1</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >0</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >0</span>
 <span class=hljs-number >20352</span> │       <span class=hljs-number >0</span>          <span class=hljs-number >1</span>     <span class=hljs-number >55</span>          <span class=hljs-number >0</span>         <span class=hljs-number >0</span>      <span class=hljs-number >0</span>       <span class=hljs-number >0</span>        <span class=hljs-number >0</span>             <span class=hljs-number >0</span>              <span class=hljs-number >0</span>               <span class=hljs-number >0</span>        <span class=hljs-number >1</span>              <span class=hljs-number >0</span>        <span class=hljs-number >0</span>                    <span class=hljs-number >0</span>          <span class=hljs-number >0</span>
                                                                                                                                                                            <span class=hljs-number >20337</span> rows omitted</code></pre>
<ul>
<li><p>The above line of code loads the <code>covid_cleaned.csv</code>, converts it into a data frame, and saves it in a variable named <code>data</code>. </p>

</ul>
<h3 id=specifying_the_target_and_predictors ><a href="#specifying_the_target_and_predictors">Specifying the target and predictors </a></h3>
<p>The <code>ScikitLearn</code> package only accepts the data in array form, hence we need to convert our data into Arrays </p>
<pre><code class="julia hljs">X = convert(<span class=hljs-built_in >Array</span>, data[!,Not(:covid_res)])
y = convert(<span class=hljs-built_in >Array</span>, data[!,:covid_res]) <span class=hljs-comment ># :covid_res is our target variable</span></code></pre>
<ul>
<li><p>The first line of code tells Julia to select all columns except <code>covid_res</code> from <code>data</code> and store it in a new variable <code>X</code> as an Array. </p>

<li><p>The second line of code tells Julia to just select <code>covid_res</code> from <code>data</code> and save them in <code>y</code> as an Array. </p>

<li><p>Here we are converting the data from DataFrame type to Array type because <code>ScikitLearn</code> only accepts the predictors and targets as Array data type. </p>

</ul>
<h3 id=splitting_the_data_into_training_set_and_test_set ><a href="#splitting_the_data_into_training_set_and_test_set">Splitting the data into training set and test set </a></h3>
<pre><code class="julia hljs"><span class=hljs-meta >@sk_import</span> model_selection: train_test_split
X_train, X_test, y_train, y_test = train_test_split(X,y, test_size = <span class=hljs-number >0.33</span>, random_state=<span class=hljs-number >42</span>) <span class=hljs-comment ># You can define the train/test size ratio using the test_size argument</span></code></pre>
<ul>
<li><p>The first line of code loads the <code>train_test_split</code> function to our project&#39;s scope from <code>ScikitLearn</code> package. </p>

<li><p>The second line of code splits the X &amp; Y into training and test sets. In the example we have set the ratio to be 50&#37;. In general, a common ratio for training-test spilt is 80-20. i.e., 80&#37; of the data will be used as training data and 20&#37; as test data. To change the ratio to 80-20, you can change the <code>test_size</code> value to 0.2. </p>

<li><p>If you want random sampling while splitting the data, assign a number to the <code>random_state</code> variable.</p>

</ul>
<h3 id=model_definition ><a href="#model_definition">Model Definition </a></h3>
<pre><code class="julia hljs"><span class=hljs-meta >@sk_import</span> linear_model: LogisticRegression
simplelogistic =LogisticRegression(penalty=:none)</code></pre>
<ul>
<li><p>This is how you define a simple logistic regression. <code>LogisticRegression&#40;&#41;</code> is equally correct, but when you don&#39;t specify penalty to be <code>:none</code>, scikit learn chooses L2 regularization by default. </p>

</ul>
<h3 id=model_fitting ><a href="#model_fitting">Model Fitting </a></h3>
<pre><code class="julia hljs">fit!(simplelogistic,X_train,y_train)</code></pre>
<ul>
<li><p>This will fit your model to the training dataset. </p>

</ul>
<h3 id=model_evaluation ><a href="#model_evaluation">Model Evaluation </a></h3>
<p>Classification report with the training data: </p>
<pre><code class="julia hljs">y_pred = predict(simplelogistic,X_train)

<span class=hljs-meta >@sk_import</span> metrics: classification_report
print(classification_report(y_train,y_predict))</code></pre>
<pre><code class="julia hljs">&gt;	      precision    recall  f1-score   support

           <span class=hljs-number >0</span>       <span class=hljs-number >0.63</span>      <span class=hljs-number >0.45</span>      <span class=hljs-number >0.52</span>      <span class=hljs-number >5684</span>
           <span class=hljs-number >1</span>       <span class=hljs-number >0.67</span>      <span class=hljs-number >0.81</span>      <span class=hljs-number >0.74</span>      <span class=hljs-number >7951</span>

    accuracy                           <span class=hljs-number >0.66</span>     <span class=hljs-number >13635</span>
   <span class=hljs-keyword >macro</span> avg       <span class=hljs-number >0.65</span>      <span class=hljs-number >0.63</span>      <span class=hljs-number >0.63</span>     <span class=hljs-number >13635</span>
weighted avg       <span class=hljs-number >0.65</span>      <span class=hljs-number >0.66</span>      <span class=hljs-number >0.65</span>     <span class=hljs-number >13635</span></code></pre>
<p>Classification report with the test data:</p>
<pre><code class="julia hljs">y_pred = predict(simplelogistic,X_test)
print(classification_report(y_test,y_pred))</code></pre>
<pre><code class="julia hljs">&gt;              precision    recall  f1-score   support

           <span class=hljs-number >0</span>       <span class=hljs-number >0.64</span>      <span class=hljs-number >0.45</span>      <span class=hljs-number >0.53</span>      <span class=hljs-number >2763</span>
           <span class=hljs-number >1</span>       <span class=hljs-number >0.68</span>      <span class=hljs-number >0.82</span>      <span class=hljs-number >0.74</span>      <span class=hljs-number >3954</span>

    accuracy                           <span class=hljs-number >0.67</span>      <span class=hljs-number >6717</span>
   <span class=hljs-keyword >macro</span> avg       <span class=hljs-number >0.66</span>      <span class=hljs-number >0.64</span>      <span class=hljs-number >0.64</span>      <span class=hljs-number >6717</span>
weighted avg       <span class=hljs-number >0.66</span>      <span class=hljs-number >0.67</span>      <span class=hljs-number >0.66</span>      <span class=hljs-number >6717</span></code></pre>
<h4 id=cross_validation ><a href="#cross_validation">Cross Validation </a></h4>
<pre><code class="julia hljs"><span class=hljs-meta >@sk_import</span> model_selection: cross_val_score
cross_val_score(LogisticRegression(penalty=:none ), X_train, y_train)</code></pre>
<pre><code class="julia hljs"><span class=hljs-number >5</span>-element <span class=hljs-built_in >Array</span>{<span class=hljs-built_in >Float64</span>,<span class=hljs-number >1</span>}:
 <span class=hljs-number >0.6615328199486615</span>
 <span class=hljs-number >0.6563989732306564</span>
 <span class=hljs-number >0.6604327099376605</span>
 <span class=hljs-number >0.6585991932526586</span>
 <span class=hljs-number >0.654932159882655</span></code></pre>
<h4 id=confusion_matrix ><a href="#confusion_matrix">Confusion Matrix </a></h4>
<pre><code class="julia hljs"><span class=hljs-meta >@sk_import</span> metrics: plot_confusion_matrix
plot_confusion_matrix(simplelogistic,X_train,y_train)
PyPlot.gcf()</code></pre>
<p><img src="/CognitiveModelingLabWebsite/img/cmatrix_logistic.PNG" alt="" /></p>
<div class=page-foot >
  <div class=copyright >
    &copy; Cognitive Informatics and Statistics Lab. Last modified: February 25, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    </div>